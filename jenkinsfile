pipeline{
    agent any
    environment{
                PATH = "$PATH:/usr/local/bin/"
    }
    stages{
        stage('code package'){
            steps{
                 script{
                def mvnpath = tool name: 'maven3', type: 'maven'
                sh script: "${mvnpath}/bin/mvn clean package"
                }
            }
        }
        stage('docker ssh'){
            steps{
            script{
            def downvar = 'docker-compose down'
            def upvar = 'docker-compose up -d'
                sshagent (credentials: ['deploy-dev']) {
                   sh "ssh StrictHostKeyChecking=no centos@34.227.79.221 ${downvar}"
                   sh "ssh StrictHostKeyChecking=no centos@34.227.79.221 ${upvar}"
              }  
              }
            }
        }
    }
}
