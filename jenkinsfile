pipeline{
    agent any
    environment{
                PATH = "$PATH:/usr/local/bin/"
    }
    stages{
        stage('code package'){
            steps{
                 script{
                def mvnpath = tool name: 'maven3', type: 'maven'
                sh script: "${mvnpath}/bin/mvn clean package"
                }
            }
        }
        stage('docker ssh'){
            steps{
                sshagent (credentials: ['deploy-dev']) {
                   sh '
                   ssh -o StrictHostKeyChecking=no centos@34.227.79.221
                   ssh  'docker-compose down'
                   ssh  'docker-compose up -d'
                   '
              }  
            }
        }
    }
}
